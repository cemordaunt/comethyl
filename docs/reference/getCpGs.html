<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read Bismark CpG reports — getCpGs • comethyl</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Read Bismark CpG reports — getCpGs" />
<meta property="og:description" content="getCpGs() reads individual sample Bismark CpG reports into a single
BSseq object and then saves it as a .rds file." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">comethyl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CpG_Cluster_Analysis.html">CpG Cluster Analysis</a>
    </li>
    <li>
      <a href="../articles/Gene_Body_Analysis.html">Gene Body Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/cemordaunt/comethyl/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read Bismark CpG reports</h1>
    <small class="dont-index">Source: <a href='https://github.com/cemordaunt/comethyl/blob/master/R/Get_and_Filter_CpGs.R'><code>R/Get_and_Filter_CpGs.R</code></a></small>
    <div class="hidden name"><code>getCpGs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>getCpGs()</code> reads individual sample Bismark CpG reports into a single
<a href='https://rdrr.io/pkg/bsseq/man/BSseq-class.html'>BSseq</a> object and then saves it as a .rds file.</p>
    </div>

    <pre class="usage"><span class='fu'>getCpGs</span><span class='op'>(</span>
  <span class='va'>colData</span>,
  path <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/getwd.html'>getwd</a></span><span class='op'>(</span><span class='op'>)</span>,
  pattern <span class='op'>=</span> <span class='st'>"*CpG_report.txt.gz"</span>,
  sameLoci <span class='op'>=</span> <span class='cn'>TRUE</span>,
  chroms <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"chr"</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fl'>22</span>, sep <span class='op'>=</span> <span class='st'>""</span><span class='op'>)</span>, <span class='st'>"chrX"</span>, <span class='st'>"chrY"</span>, <span class='st'>"chrM"</span><span class='op'>)</span>,
  BPPARAM <span class='op'>=</span> <span class='fu'>BiocParallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/BiocParallel/man/MulticoreParam-class.html'>MulticoreParam</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>,
  save <span class='op'>=</span> <span class='cn'>TRUE</span>,
  file <span class='op'>=</span> <span class='st'>"Unfiltered_BSseq.rds"</span>,
  verbose <span class='op'>=</span> <span class='cn'>TRUE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>colData</th>
      <td><p>A <code>data.frame</code> whose row names specify CpG reports to
load into the <a href='https://rdrr.io/pkg/bsseq/man/BSseq-class.html'>BSseq</a> object and whose columns
are sample traits with numeric values.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>A <code>character</code> giving the path(s) to the CpG reports.</p></td>
    </tr>
    <tr>
      <th>pattern</th>
      <td><p>A regular expression used to filter for CpG reports.</p></td>
    </tr>
    <tr>
      <th>sameLoci</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> indicating whether CpG reports contain
the same set of methylation loci. This is the case if the files are
genome wide cytosine reports aligned to the same reference genome.
The default <code>sameLoci = TRUE</code> speeds up <code>getCpGs()</code> by
only having to parse each CpG report once.</p></td>
    </tr>
    <tr>
      <th>chroms</th>
      <td><p>A <code>character</code> giving the chromosomes to include in the
<a href='https://rdrr.io/pkg/bsseq/man/BSseq-class.html'>BSseq</a> object.</p></td>
    </tr>
    <tr>
      <th>BPPARAM</th>
      <td><p>A <a href='https://rdrr.io/pkg/BiocParallel/man/BiocParallelParam-class.html'>BiocParallel::BiocParallelParam</a> instance providing the
parallel back-end to use during evaluation.</p></td>
    </tr>
    <tr>
      <th>save</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> indicating whether to save the
<a href='https://rdrr.io/pkg/bsseq/man/BSseq-class.html'>BSseq</a> object.</p></td>
    </tr>
    <tr>
      <th>file</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> giving the file name (.rds) for the saved
<a href='https://rdrr.io/pkg/bsseq/man/BSseq-class.html'>BSseq</a> object.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code> indicating whether messages should be
printed.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <a href='https://rdrr.io/pkg/bsseq/man/BSseq-class.html'>BSseq</a> object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This <a href='https://rdrr.io/pkg/bsseq/man/BSseq-class.html'>BSseq</a> object still needs to be filtered for
coverage at individual CpGs. More information on these arguments is given in
the documentation for <code><a href='https://rdrr.io/pkg/bsseq/man/read.bismark.html'>bsseq::read.bismark()</a></code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>
<ul>
<li><p><code><a href='getCpGtotals.html'>getCpGtotals()</a></code> and <code><a href='plotCpGtotals.html'>plotCpGtotals()</a></code> for help with deciding
coverage cutoffs.</p></li>
<li><p><code><a href='filterCpGs.html'>filterCpGs()</a></code> to filter the <a href='https://rdrr.io/pkg/bsseq/man/BSseq-class.html'>BSseq</a> object.</p></li>
<li><p><code><a href='https://rdrr.io/pkg/bsseq/man/read.bismark.html'>bsseq::read.bismark()</a></code> for more details on the arguments and
the underlying functions.</p></li>
</ul>
</div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>

<span class='co'># Read Bismark CpG Reports</span>
<span class='va'>colData</span> <span class='op'>&lt;-</span> <span class='fu'>read.xlsx</span><span class='op'>(</span><span class='st'>"sample_info.xlsx"</span>, rowNames <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>bs</span> <span class='op'>&lt;-</span> <span class='fu'>getCpGs</span><span class='op'>(</span><span class='va'>colData</span>, file <span class='op'>=</span> <span class='st'>"Unfiltered_BSseq.rds"</span><span class='op'>)</span>

<span class='co'># Examine CpG Totals at Different Cutoffs</span>
<span class='va'>CpGtotals</span> <span class='op'>&lt;-</span> <span class='fu'><a href='getCpGtotals.html'>getCpGtotals</a></span><span class='op'>(</span><span class='va'>bs</span>, file <span class='op'>=</span> <span class='st'>"CpG_Totals.txt"</span><span class='op'>)</span>
<span class='fu'><a href='plotCpGtotals.html'>plotCpGtotals</a></span><span class='op'>(</span><span class='va'>CpGtotals</span>, file <span class='op'>=</span> <span class='st'>"CpG_Totals.pdf"</span><span class='op'>)</span>

<span class='co'># Filter BSseq Object</span>
<span class='va'>bs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='filterCpGs.html'>filterCpGs</a></span><span class='op'>(</span><span class='va'>bs</span>, cov <span class='op'>=</span> <span class='fl'>2</span>, perSample <span class='op'>=</span> <span class='fl'>0.75</span>, file <span class='op'>=</span> <span class='st'>"Filtered_BSseq.rds"</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Charles Mordaunt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


