<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="plotSDstats() takes a set of regions from getRegions(), generates
heatmaps of methylation standard deviation against region features, and saves
it as a pdf. Compared features include number of CpGs, minimum coverage, mean
coverage, and mean methylation."><title>Plot Heatmaps of Region Standard Deviation vs Features — plotSDstats • comethyl</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Heatmaps of Region Standard Deviation vs Features — plotSDstats"><meta property="og:description" content="plotSDstats() takes a set of regions from getRegions(), generates
heatmaps of methylation standard deviation against region features, and saves
it as a pdf. Compared features include number of CpGs, minimum coverage, mean
coverage, and mean methylation."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">comethyl</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/comethyl.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/CpG_Cluster_Analysis.html">CpG Cluster Analysis</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/Gene_Body_Analysis.html">Gene Body Analysis</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/Module_Preservation.html">Module Preservation</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cemordaunt/comethyl/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot Heatmaps of Region Standard Deviation vs Features</h1>
      <small class="dont-index">Source: <a href="https://github.com/cemordaunt/comethyl/blob/HEAD/R/Get_and_Filter_Regions.R" class="external-link"><code>R/Get_and_Filter_Regions.R</code></a></small>
      <div class="d-none name"><code>plotSDstats.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>plotSDstats()</code> takes a set of regions from <code><a href="getRegions.html">getRegions()</a></code>, generates
heatmaps of methylation standard deviation against region features, and saves
it as a pdf. Compared features include number of CpGs, minimum coverage, mean
coverage, and mean methylation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">plotSDstats</span><span class="op">(</span>
  <span class="va">regions</span>,
  maxQuantile <span class="op">=</span> <span class="fl">1</span>,
  bins <span class="op">=</span> <span class="fl">30</span>,
  nBreaks <span class="op">=</span> <span class="fl">4</span>,
  legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.09</span>, <span class="fl">0.9</span><span class="op">)</span>,
  save <span class="op">=</span> <span class="cn">TRUE</span>,
  file <span class="op">=</span> <span class="st">"SD_Plots.pdf"</span>,
  width <span class="op">=</span> <span class="fl">8.5</span>,
  height <span class="op">=</span> <span class="fl">8.5</span>,
  verbose <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>regions</dt>
<dd><p>A <code>data.frame</code> output from <code><a href="getRegions.html">getRegions()</a></code> giving the set
of regions and statistics for each region.</p></dd>
<dt>maxQuantile</dt>
<dd><p>A <code>numeric(1)</code> giving the maximum quantile of each
feature to plot.</p></dd>
<dt>bins</dt>
<dd><p>A <code>numeric(1)</code> specifying the number of bins for both axes
in each heatmap.</p></dd>
<dt>nBreaks</dt>
<dd><p>A <code>numeric(1)</code> specifying the number of breaks for both
axes.</p></dd>
<dt>legend.position</dt>
<dd><p>A <code>numeric(2)</code> specifying the position of the
legend, as x-axis, y-axis. May also be a <code>character(1)</code>
indicating "none", "left", "right", "bottom", or "top".</p></dd>
<dt>save</dt>
<dd><p>A <code>logical(1)</code> indicating whether to save the plot.</p></dd>
<dt>file</dt>
<dd><p>A <code>character(1)</code> giving the file name (.pdf) for the plot.</p></dd>
<dt>width</dt>
<dd><p>A <code>numeric(1)</code> specifying the width in inches of the saved
plot.</p></dd>
<dt>height</dt>
<dd><p>A <code>numeric(1)</code> specifying the height in inches of the saved
plot.</p></dd>
<dt>verbose</dt>
<dd><p>A <code>logical(1)</code> indicating whether messages should be
printed.</p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggplot</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>It's recommended examine these plots before and after filtering to ensure
removal of regions with high variability due to insufficient data. Plots are
heatmaps of 2D bin counts, with the color indicating the number of regions in
that bin on the log10 scale. A <code>ggplot</code> object is produced and can be
edited outside of this function if desired.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="getRegions.html">getRegions()</a></code> to generate the set of regions.</p></li>
<li><p><code><a href="plotRegionStats.html">plotRegionStats()</a></code>, <code><a href="getRegionTotals.html">getRegionTotals()</a></code>, and <code><a href="plotRegionTotals.html">plotRegionTotals()</a></code>
for more help visualizing region characteristics and setting
cutoffs for filtering.</p></li>
<li><p><code><a href="filterRegions.html">filterRegions()</a></code> for filtering regions by minimum coverage and
methylation standard deviation.</p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Call Regions</span></span>
<span class="r-in"><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="getRegions.html">getRegions</a></span><span class="op">(</span><span class="va">bs</span>, file <span class="op">=</span> <span class="st">"Unfiltered_Regions.txt"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plotRegionStats.html">plotRegionStats</a></span><span class="op">(</span><span class="va">regions</span>, maxQuantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span class="r-in">                file <span class="op">=</span> <span class="st">"Unfiltered_Region_Plots.pdf"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">plotSDstats</span><span class="op">(</span><span class="va">regions</span>, maxQuantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span class="r-in">            file <span class="op">=</span> <span class="st">"Unfiltered_SD_Plots.pdf"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Examine Region Totals at Different Cutoffs</span></span>
<span class="r-in"><span class="va">regionTotals</span> <span class="op">&lt;-</span> <span class="fu"><a href="getRegionTotals.html">getRegionTotals</a></span><span class="op">(</span><span class="va">regions</span>, file <span class="op">=</span> <span class="st">"Region_Totals.txt"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plotRegionTotals.html">plotRegionTotals</a></span><span class="op">(</span><span class="va">regionTotals</span>, file <span class="op">=</span> <span class="st">"Region_Totals.pdf"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Filter Regions</span></span>
<span class="r-in"><span class="va">regions</span> <span class="op">&lt;-</span> <span class="fu"><a href="filterRegions.html">filterRegions</a></span><span class="op">(</span><span class="va">regions</span>, covMin <span class="op">=</span> <span class="fl">10</span>, methSD <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span class="r-in">                         file <span class="op">=</span> <span class="st">"Filtered_Regions.txt"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plotRegionStats.html">plotRegionStats</a></span><span class="op">(</span><span class="va">regions</span>, maxQuantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span class="r-in">                file <span class="op">=</span> <span class="st">"Filtered_Region_Plots.pdf"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">plotSDstats</span><span class="op">(</span><span class="va">regions</span>, maxQuantile <span class="op">=</span> <span class="fl">0.99</span>,</span>
<span class="r-in">            file <span class="op">=</span> <span class="st">"Filtered_SD_Plots.pdf"</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Charles Mordaunt.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer></div>

  

  

  </body></html>

